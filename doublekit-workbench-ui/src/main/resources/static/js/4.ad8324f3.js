(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{263:function(e,t,a){"use strict";a(310);var n=a(307),r=a(0),c=a.n(r),i=a(144),s="privilege-breadcrumb--2Po42";t.a=function(e){var t=e.routes;return c.a.createElement("div",{className:s},c.a.createElement(n.a,{itemRender:function(e,t,a){var n=a.indexOf(e)===a.length-1;return e.disabled?c.a.createElement("span",null,e.breadcrumbName):n?e.click?c.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return e.click()}},e.breadcrumbName):c.a.createElement("span",null,e.breadcrumbName):e.click?c.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return e.click()}},e.breadcrumbName):c.a.createElement(i.b,{to:e.path},e.breadcrumbName)},routes:t,separator:">"}))}},385:function(e){e.exports=JSON.parse('{"website":{"title":"输入的值","img":"模板封面图片url地址","content":"内容体"},"wechat":{"title":"标题","img":"封面图片url地址","content":"内容体"},"dingding":{"title":"标题","img":"封面图片url地址","content":"内容体"},"SMS":{"content":"内容体"}}')},393:function(e,t,a){"use strict";a.r(t);a(248);var n=a(247),r=(a(241),a(243)),c=(a(132),a(63)),i=(a(242),a(244)),s=(a(246),a(245)),l=a(10),o=a.n(l),m=(a(254),a(255)),u=a(41),d=a.n(u),g=a(38),p=a.n(g),b=a(0),f=a.n(b),v=a(133),y=a(68),E=a(263),O=a(46),j=(a(250),a(249)),h=a(88),S=["receiverContact"];function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){o()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var C,k=function(e){var t=Object(y.a)().t,a=e.visible,l=e.onCancel,o=e.id,u=[{title:t("message-send-type"),dataIndex:["messageSendType","name"],key:"title"},{title:t("message-management-detail-tab-table-title"),dataIndex:["receiver","name"]},{title:t("message-management-detail-tab-table-phone"),dataIndex:"receiverContact"},{title:t("message-management-detail-tab-table-sendtime"),dataIndex:"sendtime"},{title:t("message-management-detail-tab-table-receivetime"),dataIndex:"receivetime",key:"receivetime"},{title:t("message-management-detail-tab-table-sendingtime"),dataIndex:"sendingtime",key:"sendingtime"},{title:t("message-management-detail-tab-table-status"),dataIndex:"status",key:"status"},{title:t("message-table-action"),dataIndex:"action",key:"action",render:function(e,a){return f.a.createElement(m.b,{size:"middle"},f.a.createElement("a",null,t("message-management-detail-tab-table-viewdatail")))}}],g=Object(b.useState)([]),v=d()(g,2),E=v[0],O=v[1],P=Object(b.useState)(""),C=d()(P,2),k=C[0],x=C[1],I=Object(b.useState)(10),T=d()(I,1)[0],N=Object(b.useState)(1),D=d()(N,2),R=D[0],z=D[1],M=Object(b.useState)(0),U=d()(M,2),F=U[0],L=U[1],V=Object(b.useState)({messageId:o,pageParam:{pageSize:T,currentPage:R}}),J=d()(V,2),A=J[0],K=J[1];Object(b.useEffect)((function(){o&&q(w(w({},A),{},{messageId:o}))}),[A,o]);var q=function(e){h.a.post("/messageDispatchItem/findMessageDispatchItemPage",e).then((function(e){e.code||(L(e.data.totalRecord),O(e.data.dataList))}))};return f.a.createElement(j.a,{visible:a,closable:!1,title:t("message-view-log"),width:1200,footer:[f.a.createElement(c.a,{key:"submit",type:"primary",onClick:function(){l()}},t("message-close"))]},f.a.createElement(r.a,null,f.a.createElement(i.a,{span:24},f.a.createElement("div",{className:"card-container"},f.a.createElement(r.a,{gutter:[16,24]},f.a.createElement(i.a,{span:8},f.a.createElement(s.a,{placeholder:"".concat(t("message-management-detail-tab-table-phone")),value:k,onChange:function(e){return x(e.target.value)},onPressEnter:function(e){return function(e){var t=e.target.value;z(1);A.receiverContact;var a=w(w({},p()(A,S)),{},{pageParam:{pageSize:T,currentPage:1}});t&&(a.receiverContact=t),K(a)}(e)}}))),f.a.createElement(r.a,null,f.a.createElement(i.a,{span:24},f.a.createElement(n.a,{dataSource:E,columns:u,rowKey:function(e){return e.id},tableLayout:"fixed",pagination:{current:R,pageSize:T,total:F},onChange:function(e,t,a){return function(e,t,a){z(e.current);var n=w(w({},A),{},{orderParams:[],pageParam:{pageSize:T,currentPage:e.current}});K(n)}(e)}})))))))},x=(a(259),a(256)),I=s.a.TextArea,T=x.a.TabPane,N=function(e){var t=Object(y.a)().t,a=e.visible,s=e.onCancel,l=e.data,o=[{title:t("doublekit-message-management-detail-tab-table-title"),dataIndex:["receiver","name"]},{title:t("doublekit-message-management-detail-tab-table-phone"),dataIndex:"receiverContact"},{title:t("doublekit-message-table-action"),dataIndex:"action",key:"action"}];return f.a.createElement(j.a,{visible:a,closable:!1,title:t("doublekit-message-modal-title"),width:1200,footer:[f.a.createElement(c.a,{key:"submit",type:"primary",onClick:function(){s()}},t("message-table-cancel"))]},f.a.createElement(r.a,{className:"padding-8"},f.a.createElement(i.a,{span:2,style:{textAlign:"right",marginRight:"10px"}},f.a.createElement("label",null,"消息标题:")),f.a.createElement(i.a,{span:16},l.messageTemplate&&l.messageTemplate.title)),f.a.createElement(r.a,{className:"padding-8"},f.a.createElement(i.a,{span:2,style:{textAlign:"right",marginRight:"10px"}},f.a.createElement("label",null,"发送者:")),f.a.createElement(i.a,{span:16},l.sender&&l.sender.name)),f.a.createElement(r.a,{className:"padding-8"},f.a.createElement(i.a,{span:2,style:{textAlign:"right",marginRight:"10px"}},f.a.createElement("label",null,"接收时间:")),f.a.createElement(i.a,{span:16},l.receiveTime)),f.a.createElement(r.a,{className:"padding-8"},f.a.createElement(i.a,{span:2,style:{textAlign:"right",marginRight:"10px"}},f.a.createElement("label",null,"消息内容:")),f.a.createElement(i.a,{span:16},f.a.createElement(I,{value:l.data,autoSize:{minRows:3,maxRows:5},disabled:!0}))),f.a.createElement(r.a,null,f.a.createElement(i.a,{span:24},f.a.createElement("div",{className:"card-container"},f.a.createElement(x.a,{type:"card"},f.a.createElement(T,{tab:t("doublekit-message-management-detail-tab-table-title"),key:"1"},f.a.createElement(r.a,null,f.a.createElement(i.a,{span:24},f.a.createElement(n.a,{columns:o,dataSource:l.messageReceiverList||[],rowKey:function(e){return e.id},tableLayout:"fixed"})))))))))},D=a(176),R=a.n(D),z=(a(253),a(251)),M=(a(260),a(257)),U=new Uint8Array(16);function F(){if(!C&&!(C="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return C(U)}var L=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var V=function(e){return"string"==typeof e&&L.test(e)},J=[],A=0;A<256;++A)J.push((A+256).toString(16).substr(1));var K=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=(J[e[t+0]]+J[e[t+1]]+J[e[t+2]]+J[e[t+3]]+"-"+J[e[t+4]]+J[e[t+5]]+"-"+J[e[t+6]]+J[e[t+7]]+"-"+J[e[t+8]]+J[e[t+9]]+"-"+J[e[t+10]]+J[e[t+11]]+J[e[t+12]]+J[e[t+13]]+J[e[t+14]]+J[e[t+15]]).toLowerCase();if(!V(a))throw TypeError("Stringified UUID is invalid");return a};var q=function(e,t,a){var n=(e=e||{}).random||(e.rng||F)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){a=a||0;for(var r=0;r<16;++r)t[a+r]=n[r];return t}return K(n)};function $(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function W(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?$(Object(a),!0).forEach((function(t){o()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var B={labelCol:{span:6},wrapperCol:{span:18}},G=M.a.Option,H=function(e){var t=Object(y.a)().t,a=z.a.useForm(),n=d()(a,1)[0],c=e.visible,l=e.onCancel,o=Object(b.useState)([]),m=d()(o,2),u=m[0],g=m[1];Object(b.useEffect)((function(){p({pageParam:{pageSize:1,currentPage:9999}})}),[]);var p=function(e){h.a.post("/user/findUserList",e).then((function(e){e.code||g(e.data)}))};return f.a.createElement(j.a,{visible:c,closable:!1,title:t("message-management-add-user"),destroyOnClose:!0,okText:t("message-save"),cancelText:t("message-table-cancel"),onOk:function(){n.validateFields().then((function(e){var t={};e.receiver>=0&&(t.receiverName=u[e.receiver].name,t.receiver=u[e.receiver].id),t=W(W({receiverContact:e.receiverContact},t),{},{id:q()}),l(t)}))},onCancel:function(){l()}},f.a.createElement(r.a,null,f.a.createElement(i.a,{span:24},f.a.createElement(z.a,R()({},B,{form:n,preserve:!1}),f.a.createElement(z.a.Item,{name:"receiver",label:t("message-management-detail-tab-table-title"),dependencies:["receiverContact"],rules:[{validator:function(e,a,r){n.getFieldValue("receiverContact")||a>=0?r():r("".concat(t("message-management-detail-tab-table-title"),"  和 ").concat(t("message-phone"),"必填一项")),r()}}]},f.a.createElement(M.a,null,u.map((function(e,t){return f.a.createElement(G,{value:t,key:e.id},e.name)})))),f.a.createElement(z.a.Item,{name:"receiverContact",label:t("message-phone"),dependencies:["receiver"],rules:[{validator:function(e,a,r){var c=n.getFieldValue("receiver");c>=0?(!/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/.test(a)&&a&&r("".concat(t("message-phone"),"格式不正确")),r()):/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/.test(a)?0!==c&&c&&!a&&r("".concat(t("message-phone")," 和 ").concat(t("message-management-detail-tab-table-title"),"必填一项")):r("".concat(t("message-phone"),"格式不正确")),r()}}]},f.a.createElement(s.a,null))))))},Q=a(39),X=a.n(Q),Y=a(385);function Z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(a),!0).forEach((function(t){o()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Z(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ee=M.a.Option,te=s.a.TextArea,ae=x.a.TabPane,ne={labelCol:{span:2},wrapperCol:{span:22}},re=function(e){var t=Object(y.a)().t,a=z.a.useForm(),s=d()(a,1)[0],l=e.visible,o=e.onCancel,u=e.onOpenUserModal,g=e.userTable,p=e.removeUser,v=[{title:t("message-management-detail-tab-table-title"),dataIndex:"receiverName",key:"receiverName"},{title:t("message-management-detail-tab-table-phone"),dataIndex:"receiverContact",key:"receiverContact"},{title:t("message-table-action"),dataIndex:"action",key:"action",render:function(e,a){return f.a.createElement(m.b,{size:"middle"},f.a.createElement("a",{onClick:function(){return k(a.id)}},t("message-delete")))}}],E=Object(b.useState)([]),O=d()(E,2),S=O[0],P=O[1];Object(b.useEffect)((function(){C({pageParam:{pageSize:1,currentPage:9999}})}),[]);var w=function(){o()},C=function(e){h.a.post("/messageTemplate/findMessageTemplateList",e).then((function(e){e.code||P(e.data)}))},k=function(e){p(e)};return f.a.createElement(j.a,{visible:l,closable:!1,destroyOnClose:!0,title:t("message-send"),width:1200,okText:t("message-immediately-send"),cancelText:t("message-table-cancel"),onOk:function(){s.validateFields().then((function(e){var t=_(_({},e),{},{messageTemplate:{id:e.messageTemplate},messageReceiverList:g.map((function(e){var t={};return e.receiver&&(t.receiver={id:e.receiver}),e.receiverContact&&(t.receiverContact=e.receiverContact),t}))});h.a.post("/message/sendMessage",t).then((function(e){e.code||w()}))}))},onCancel:w},f.a.createElement(r.a,null,f.a.createElement(i.a,{span:24},f.a.createElement(z.a,R()({},ne,{form:s,preserve:!1}),f.a.createElement(z.a.Item,{name:"messageTemplate",label:t("message-template"),rules:[{required:!0,message:"".concat(t("message-template")," 必填")}]},f.a.createElement(M.a,{onSelect:function(e){var t=S.findIndex((function(t){return t.id===e})),a=S[t].msgSendType.code;if(Y[a]){var n=Y[a];s.setFieldsValue({data:JSON.stringify(n)})}}},S.map((function(e){return f.a.createElement(ee,{value:e.id,key:e.id},e.name)})))),f.a.createElement(z.a.Item,{name:"data",label:t("message-modal-content"),rules:[{required:!0,message:"".concat(t("message-modal-content")," 必填")},{required:!0,validator:function(e,t,a){if(t)try{"object"==X()(JSON.parse(t))&&a()}catch(e){a("数据统一用JSON格式定义")}a()}}]},f.a.createElement(te,{autoSize:{minRows:5,maxRows:5},placeholder:"数据统一用JSON格式定义"}))))),f.a.createElement(r.a,null,f.a.createElement(i.a,{span:24},f.a.createElement("div",{className:"card-container"},f.a.createElement(x.a,{type:"card"},f.a.createElement(ae,{tab:t("message-management-detail-tab-table-title"),key:"1"},f.a.createElement(r.a,{justify:"space-between"},f.a.createElement(i.a,{span:24},f.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},f.a.createElement(c.a,{onClick:u,type:"primary"},"+",t("message-management-add-user"))))),f.a.createElement(r.a,null,f.a.createElement(i.a,{span:24},f.a.createElement(n.a,{columns:v,dataSource:g,rowKey:function(e){return e.id},tableLayout:"fixed"})))))))))},ce=function(e){var t=e.visible,a=e.onCancel,n=e.userTable,r=void 0===n?[]:n,c=e.userVisible,i=e.onUserCancel,s=e.messageType,l=void 0===s?[]:s,o=e.user,m=void 0===o?[]:o,u=e.onOpenUserModal,d=e.removeUser;return f.a.createElement("div",null,f.a.createElement(H,{visible:c,onCancel:i,messageType:l,user:m}),f.a.createElement(re,{visible:t,onCancel:a,userTable:r,onOpenUserModal:u,removeUser:d}))},ie=a(120),se=["messageManagementStore"],le=["title"];function oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function me(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(a),!0).forEach((function(t){o()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ue=[{disabled:!0,breadcrumbName:"消息管理 "},{path:"list",breadcrumbName:"消息列表"}];t.default=Object(v.b)(ie.a)(Object(v.c)((function(e){var t=Object(y.a)().t,a=e.messageManagementStore,l=(p()(e,se),a.getMessageManagementData),o=a.messageManagementData,u=Object(b.useState)(!1),g=d()(u,2),v=g[0],j=g[1],S=Object(b.useState)(!1),P=d()(S,2),w=P[0],C=P[1],x=Object(b.useState)(!1),I=d()(x,2),T=I[0],D=I[1],R=Object(b.useState)(!1),z=d()(R,2),M=z[0],U=z[1],F=Object(b.useState)(""),L=d()(F,2),V=L[0],J=L[1],A=Object(b.useState)(10),K=d()(A,1)[0],q=Object(b.useState)(1),$=d()(q,2),W=$[0],B=$[1],G=Object(b.useState)(0),H=d()(G,2),Q=H[0],X=H[1],Y=Object(b.useState)({pageParam:{pageSize:K,currentPage:W}}),Z=d()(Y,2),_=Z[0],ee=Z[1],te=Object(b.useState)(""),ae=d()(te,2),ne=ae[0],re=ae[1],ie=Object(b.useState)([]),oe=d()(ie,2),de=oe[0],ge=oe[1],pe=Object(b.useState)({}),be=d()(pe,2),fe=be[0],ve=be[1],ye=[{title:t("message-management-table-columns-title"),dataIndex:["messageTemplate","title"],key:"title",render:function(e,t){var a,n=t.data;if(n)try{var r=JSON.parse(n);a=r.title?r.title:e}catch(t){a=e}return f.a.createElement(m.b,{size:"middle"},f.a.createElement("a",{onClick:function(){return he(t.id)}},a))}},{title:t("message-template-modal-messagetype"),dataIndex:["messageTemplate","msgType","name"],key:"type"},{title:t("message-management-table-columns-senduser"),dataIndex:["sender","name"],key:"sender"},{title:t("message-management-table-columns-receiving-time"),dataIndex:"receiveTime",key:"receiveTime"},{title:t("message-management-table-columns-receiving-status"),dataIndex:"status",key:"status",render:function(e,t){var a=t.errorNum?t.errorNum:0;return f.a.createElement("div",{style:{cursor:"pointer"},onClick:function(){return he(t.id)}},a>0?"失败":"成功","(",f.a.createElement("span",{style:{color:"#0099FF"}},t.successNum),a>0&&"/",f.a.createElement("span",{style:{color:"#FF0066"}},a>0&&a),")")}},{title:t("message-table-action"),dataIndex:"action",key:"action",render:function(e,a){return f.a.createElement(m.b,{size:"middle"},f.a.createElement("a",{onClick:function(){return je(a.id)}},t("message-view")),f.a.createElement("a",{onClick:function(){return Oe(a.id)}},t("message-delete")))}}];Object(b.useEffect)((function(){Ee(_)}),[_]);var Ee=function(e){h.a.post("/message/findMessagePage",e).then((function(e){e.code||(X(e.data.totalRecord),l(e.data.dataList))}))},Oe=function(e){var t=new FormData;t.append("id",e),h.a.post("/message/deleteMessage",t).then((function(e){if(!e.code){var t=Object(O.a)(Q,K,W),a=me(me({},_),{},{pageParam:{pageSize:K,currentPage:t}});B(t),ee(a)}}))},je=function(e){var t=new FormData;t.append("id",e),h.a.post("/message/findMessageWithNest",t).then((function(e){e.code||(U(!0),ve(e.data))}))},he=function(e){j(!0),re(e)};return f.a.createElement("div",{id:"message-management"},f.a.createElement(r.a,{justify:"center",style:{width:"100%"}},f.a.createElement(i.a,{xl:{span:20},lg:{span:24},xxl:{span:16}},f.a.createElement(E.a,{routes:ue}),f.a.createElement(r.a,{justify:"space-between",gutter:[26,16]},f.a.createElement(i.a,{span:8},f.a.createElement(s.a,{placeholder:t("message-management-search-input"),value:V,onChange:function(e){return J(e.target.value)},onPressEnter:function(e){return function(e){var t=e.target.value;B(1);_.title;var a=me(me({},p()(_,le)),{},{pageParam:{pageSize:K,currentPage:1}});t&&(a.title=t),ee(a)}(e)}})),f.a.createElement(i.a,{span:8,offset:8},f.a.createElement("div",{className:"message-management-btn"},f.a.createElement(c.a,{onClick:function(){C(!0)}},"+",t("message-send"))))),f.a.createElement(r.a,null,f.a.createElement(i.a,{span:24},f.a.createElement(n.a,{dataSource:o,columns:ye,rowKey:function(e){return e.id},tableLayout:"fixed",pagination:{current:W,pageSize:K,total:Q},onChange:function(e,t,a){return function(e,t,a){B(e.current);var n=me(me({},_),{},{orderParams:[],pageParam:{pageSize:K,currentPage:e.current}});ee(n)}(e)}}))))),f.a.createElement(N,{visible:M,data:fe,onCancel:function(){return U(!1)}}),f.a.createElement(k,{visible:v,onCancel:function(){return j(!1)},id:ne}),f.a.createElement(ce,{visible:w,onCancel:function(){C(!1),ge([]),Ee(_)},userTable:de,userVisible:T,onUserCancel:function(e){e&&ge(de.concat(e)),D(!1)},onOpenUserModal:function(){D(!0)},removeUser:function(e){var t=de.filter((function(t){return t.id!=e}));ge(t)}}))})))}}]);