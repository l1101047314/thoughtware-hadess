(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{401:function(e,t,a){"use strict";a.r(t);a(309);var n=a(305),r=a(176),c=a.n(r),s=(a(241),a(243)),i=(a(242),a(244)),l=a(10),u=a.n(l),m=a(41),o=a.n(m),p=a(38),f=a.n(p),g=(a(259),a(256)),d=a(0),b=a.n(d),v=a(133),E=a(68),O=a(88),y=a(46),j=a(124),h=a(53),k=a.n(h),P=a(23),S=a.n(P);String.prototype.render=function(e){if(e){return this.replace(/(\\)?\{([^\{\}\\]+)(\\)?\}/g,(function(t,a,n,r){if(a||r)return t.replace("\\","");var c,s,i=n.replace(/\s/g,"").split("."),l=e;for(c=0,s=i.length;c<s;++c)if(null==(l=l[i[c]]))return"";return l}))}};var w=function(e){var t=e.id,a=e.title,n=e.status,r=e.content,c=e.receiveTime,l=e.replaceData,u=e.messageLink,m=void 0===u?"":u,o=e.history,p=function(e){return m.render(e)},f=function(){var e=k()(S.a.mark((function e(){var a,r,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||10===n){e.next=8;break}return a={id:t,status:10},e.next=4,O.a.post("/messageDispatchItem/updateMessageDispatchItem",a);case 4:e.sent.code||(r=p(l),o.push(r)),e.next=10;break;case 8:(c=p(l))&&o.push(c);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return b.a.createElement("div",{id:"site-template-message",onClick:f},b.a.createElement("div",{className:"site-template-item"},b.a.createElement(s.a,null,b.a.createElement(i.a,null,b.a.createElement("h3",null,a)),b.a.createElement(i.a,{offset:1},b.a.createElement("h3",null,0===n?"未读":"已读"))),b.a.createElement(s.a,null,b.a.createElement(i.a,{span:24},b.a.createElement("div",{className:"site-template-item-content",dangerouslySetInnerHTML:{__html:function(e){return r.render(e)}(l)}}))),b.a.createElement(s.a,null,b.a.createElement(i.a,null,b.a.createElement("div",{className:"site-template-item-date"},"日期：",c||"--")))))},T=["userMessageStore"];function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){u()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var M=g.a.TabPane;t.default=Object(v.b)(j.a)(Object(v.c)((function(e){var t=Object(E.a)().t,a=e.userMessageStore,r=(f()(e,T),Object(y.b)()),l=a.userMessageNum,u=a.setMessageNum,m=Object(d.useState)(0),p=o()(m,2),v=p[0],j=p[1],h=Object(d.useState)(1),k=o()(h,2),P=k[0],S=k[1],D=Object(d.useState)([]),N=o()(D,2),x=N[0],L=N[1],z=Object(d.useState)({pageParam:{pageSize:10,currentPage:P}}),C=o()(z,1)[0],J=Object(d.useState)([]),_=o()(J,2),H=_[0],R=_[1],q=Object(d.useState)(""),A=o()(q,2),B=A[0],F=A[1];Object(d.useEffect)((function(){u(60)}),[l]),Object(d.useEffect)((function(){G()}),[]);var G=function(){O.a.post("/messageType/findMessageTypeList",{}).then((function(e){e.code||(R(e.data),r.ticket&&(F(e.data[0].id),K(I(I({},C),{},{receiver:r.ticket,msgTypeId:e.data[0].id}))))}))},K=function(e){O.a.post("/messageDispatchItem/findMessageDispatchItemPage",e).then((function(e){e.code||(L(e.data.dataList),j(e.data.totalRecord))}))},Q=function(e){if(S(e),r.ticket){var t={pageParam:{pageSize:10,currentPage:e},receiver:r.ticket,msgTypeId:B};K(t)}};return b.a.createElement("div",{id:"user-message"},b.a.createElement(s.a,{justify:"center",style:{width:"100%"}},b.a.createElement(i.a,{xl:{span:20},lg:{span:24},xxl:{span:16}},b.a.createElement(s.a,{className:"mymessage"},b.a.createElement(i.a,null,b.a.createElement("label",null,t("message-mymessage"),":"))),b.a.createElement("div",{className:"message-card-container"},b.a.createElement(g.a,{type:"card",onChange:function(e){if(r.ticket){S(1),F(e);var t={pageParam:{pageSize:10,currentPage:1},receiver:r.ticket,msgTypeId:e};K(t)}}},H.map((function(t){return b.a.createElement(M,{tab:t.name,key:t.id},x.map((function(t){var a=t.message.data,n=void 0===a?"":a,r={title:t.messageTemplate.title,status:t.status,receiveTime:t.receiveTime};return b.a.createElement(s.a,{key:t.id},b.a.createElement(i.a,{span:24},b.a.createElement(w,c()({title:r.title,status:r.status,replaceData:JSON.parse(n),content:t.messageTemplate.content,receiveTime:r.receiveTime,messageLink:t.messageTemplate.link,id:t.id},e))))})),b.a.createElement(s.a,{justify:"center"},b.a.createElement(i.a,null,b.a.createElement(n.a,{current:P,onChange:Q,total:v}))))})))))))})))}}]);